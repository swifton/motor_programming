function execute() {
   var command = program[step];
   step += 1;
   moveBugs();
   backlight(step-1, "green");
   if (shocked > 0) {
      shocked -= 1;
      return;
   }

   switch (command) {
      case "Wait":
         break;
      case "Move":
         var x = character.coordinates[0] + character.direction[0];
         var y = character.coordinates[1] + character.direction[1];
         if (checkWalls(x, y)) break;
         if (checkBugs(x, y)) break;
         character.coordinates[0] = x;
         character.coordinates[1] = y;
         break;
      case "Turn Left":
         var tmp = character.direction[0];
         character.direction[0] = character.direction[1];
         character.direction[1] = -tmp;
	 changeAngle();
         break;
      case "Turn Right":
         var tmp = character.direction[0];
         character.direction[0] = -character.direction[1];
         character.direction[1] = tmp;
	 changeAngle();
         break;
      case "Pick Up":
         if (board[character.coordinates[0]][character.coordinates[1]] == 1) { 
            board[character.coordinates[0]][character.coordinates[1]] = 0; 
            grainsLeft -= 1;
            checkWin();
         }
         break;
   }
}

function changeAngle() {
   character.angle = directionToAngle(character.direction);
   var an = character.oldAngle - character.angle;
   if (an > Math.PI) character.oldAngle -= 2 * Math.PI;
   if (an < -Math.PI) character.oldAngle += 2 * Math.PI;
}
